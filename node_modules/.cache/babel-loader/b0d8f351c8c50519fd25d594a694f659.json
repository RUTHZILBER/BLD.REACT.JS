{"ast":null,"code":"var _jsxFileName = \"C:\\\\git\\\\BLD.REACT.JS\\\\src\\\\CheckboxesTags.js\",\n    _s = $RefreshSig$();\n\n//השלמה אוטומאטית לתגיות\nimport { React, useState, useEffect } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport TextField from '@material-ui/core/TextField';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Icon, InlineIcon } from '@iconify/react';\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\nimport magnifyingGlass from '@iconify-icons/oi/magnifying-glass';\nimport CheckBoxIcon from '@material-ui/icons/CheckBox';\nimport SystemUpdateAltIcon from '@material-ui/icons/SystemUpdateAlt';\nimport { connect } from 'react-redux';\nimport './CheckboxesTags.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst icon = /*#__PURE__*/_jsxDEV(CheckBoxOutlineBlankIcon, {\n  fontSize: \"small\"\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 14,\n  columnNumber: 14\n}, this);\n\nconst checkedIcon = /*#__PURE__*/_jsxDEV(CheckBoxIcon, {\n  fontSize: \"small\"\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 15,\n  columnNumber: 21\n}, this);\n\nfunction mapStateToProps(state) {\n  return {\n    userId: state.UserId,\n    comment: state.Comment,\n    songList: state.SongList\n  };\n}\n\nexport default connect(mapStateToProps)(_s(function CheckboxesTags(props) {\n  _s();\n\n  //שטח התגיות + אפשרויות \n  const {\n    userId,\n    comment,\n    songList,\n    severity,\n    setSeverity,\n    alertContent,\n    setAlertContent,\n    text,\n    setText,\n    errorPlay,\n    setErrorPlay\n  } = props;\n  {\n    /* רשימת כל מזהי השירים */\n  }\n  const [songsIdArray, setSongsIdArray] = useState([]); //קבלת כל השירים המורשים מתוך המאגר\n\n  const [songsArray, setSongsArray] = useState([{\n    songContect: \"thank to hashem 7\",\n    songName: \"a6\"\n  }]);\n  {\n    /* פונקציה המציגה הודעה במשך 10 שניות */\n  }\n\n  function showError() {\n    //למשך 10 שניות הצגת ההודעה\n    setTimeout(function () {\n      setErrorPlay(\"none\");\n    }.bind(this), 5000);\n    setErrorPlay(\"\");\n  }\n\n  {\n    /* פילטור השירים (פרטי או גלובלי) לתוך רשימת התגיות כתגיות  */\n  }\n\n  function filterTag() {\n    debugger;\n\n    if (window.Store.getState().SongList.length > 0) {\n      var cloneTagList = window.Store.getState().SongList.filter(rows => rows.userId == userId && comment == \"private\" || (rows.isPermit == true || rows.userId == userId) && comment == \"all\");\n      var newTagListToShow = cloneTagList.map(function (o, i) {\n        return {\n          tags: o.neatTags,\n          songName: o.songName,\n          songId: o.songId,\n          points: o.pointsTags\n        };\n      });\n      {\n        /* מפוי השירים מתוך רשימת השירים, כתגיות */\n      }\n      var cloneTagListToShow = [];\n\n      for (var i = 0; i < newTagListToShow.length; i++) {\n        var nameSong = newTagListToShow[i].songName;\n        var idSong = newTagListToShow[i].songId;\n        var tagArr = newTagListToShow[i].tags;\n        var tagPoints = newTagListToShow[i].points;\n\n        for (var j = 0; j < tagArr.length; j++) {\n          cloneTagListToShow = cloneTagListToShow.concat({\n            songName: nameSong,\n            songId: idSong,\n            tagName: tagArr[j],\n            points: tagPoints[j]\n          });\n        }\n      }\n\n      var cloneTagListToShow1 = cloneTagListToShow.sort(function (a, b) {\n        if (a.tagName < b.tagName) return parseFloat(b.points) - parseFloat(a.points) || -1;\n        if (a.tagName > b.tagName) return parseFloat(b.points) - parseFloat(a.points) || 1;\n        return parseFloat(b.points) - parseFloat(a.points) || 0; //מיון לפי נקודות ואח''כ לפי א''ב\n      });\n      debugger;\n      setTagsArray(cloneTagListToShow1);\n    } else {\n      setTimeout(filterTag, 1000); // try again in 1000 milliseconds (1 second)\n    }\n  }\n\n  useEffect(() => {\n    filterTag();\n  }, [comment]); // פונקציה המזמנת את פונקציה הורדת השיר\n\n  function downloadAllSongs(e) {\n    for (var i = 0; i < songsIdArray.length; i++) {\n      downloadTxtFile(e, songsIdArray[i]);\n    }\n  } //מתוך כל התגיות שנבחרו עם שם שיר והורדת שורה מידי תגית TXT פונקציה להורדת קובץ\n\n\n  function downloadTxtFile(e, i) {\n    var currentSongAll = songList.filter(p => p.songId == i);\n\n    if (currentSongAll.length == 1) {\n      var currentSong = currentSongAll[0];\n      var neatTags = currentSong.neatTags;\n      const element = document.createElement(\"a\");\n      var songi = \"\\n\";\n\n      for (var i = 0; i < neatTags.length; i++) {\n        songi = songi + neatTags[i] + \"\\n\";\n      }\n\n      element.href = URL.createObjectURL(new Blob([songi], {\n        type: 'text/plain;charset=utf-8'\n      }));\n      element.download = currentSong.songName + \".txt\";\n      document.body.appendChild(element);\n      element.click();\n    }\n  }\n\n  {\n    /* לצורך העלאת נקודות התגיות */\n  }\n  const [tagsArray, setTagsArray] = useState([]); //STOREלראשונה מתוך התגיות ב COMBOBOXקריאה למלוי ה\n\n  useEffect(function () {\n    filterTag();\n    return function a() {// פונקציה הקוראת כאשר מתבצעת יציאה מהקומפוננטה: alert(\" bye bye \");\n    };\n  }, []); //לפי התגית הנלחצת DB פונקציה הקוראת להעלאת הנקודות ב\n\n  function upgrowTagPointReal(e) {\n    debugger;\n    var v = e.currentTarget.firstElementChild.innerText;\n    v = v.substring(0, v.length); //?\n\n    var to = v.indexOf(\"   מהשיר   \");\n    var to2 = v.length;\n    var from2 = v.lastIndexOf(\"   מהשיר   \") + 11;\n    var tagush = v.substring(0, to);\n    var songush = v.substring(from2, to2);\n    var line = tagsArray.filter(i => i.tagName == tagush && i.songName == songush);\n\n    if (line.length != 0) {\n      upgrowTagPoint(e, line[0].tagName, line[0].songId);\n      debugger;\n      var cloneArray = songsArray.concat({\n        songId: line[0].songId,\n        songContect: line[0].songContect,\n        songName: line[0].songName + \" \" + line[0].tagName\n      });\n      setSongsArray(cloneArray); //  alert(\" התגית:  \" + tagush + \", מהשיר: \" + songush);\n\n      var cloneSongsId = [...songsIdArray];\n      var newId = line[0].songId;\n      cloneSongsId = cloneSongsId.concat(newId);\n      setSongsIdArray(cloneSongsId);\n    } else {// alert(\" השיר לא נמצא \");\n    }\n  } // DBפונקציה להעלאת הנקודות ב\n\n\n  function upgrowTagPoint(e, tagName_, songId_) {\n    debugger;\n    var json4 = JSON.stringify({\n      text: tagName_,\n      songId: songId_\n    });\n    fetch(\"http://localhost:62135/api/Tag\", {\n      method: \"PUT\",\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: json4\n    }).then(res => res.json()).then(res => {// debugger;\n      // alert(res.Data);\n    }, err => {//   debugger;\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"a\",\n    style: {\n      display: \"flex\",\n      justifyContent: \"space-around\",\n      flexDirection: \"row-reverse\",\n      flexWrap: \"wrap\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Autocomplete, {\n      style: {\n        color: \"white\",\n        display: \"flex\",\n        justifyContent: \"space-between\"\n      },\n      multiple: true // אך לא עובדת בעת הקלדת אנטר במקלדת 🎃 DB פונקציה הרצה רק בזמן לחיצת עכבר על התגית, ומעלה את ערכי הנקודות ב\n      ,\n      onChange: e => {\n        debugger;\n\n        if (e.target.checked) {\n          debugger;\n          upgrowTagPointReal(e);\n        } else {\n          debugger;\n\n          if (e.cancelable == true) {\n            // alert('on download it will be showed, sorry.');\n            setSeverity(\"warning\");\n            setAlertContent(\"בהורדת כלל השירים הנבחרים, גם שיר זה יופיע. \");\n            showError();\n          }\n        }\n\n        if (e.target.checked) console.log(\" good \");else {//alert(\" sorry, it isn't an event! \");\n        }\n      } //הלחיצה היא על תיבת הטקסט, עליה חל האנטר ולא על הנבחר ספייציפי...\n      ,\n      id: \"checkboxes-tags-demo\" // מיון התגיות לפי שמן ואחר כך לפי מספר הנקודות\n      ,\n      options: tagsArray,\n      disableCloseOnSelect: true,\n      getOptionLabel: option => option.songName,\n      renderOption: (option, {\n        selected\n      }) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Checkbox, {\n          dir: \"rtl\",\n          style: {\n            textAlign: 'right'\n          },\n          icon: icon,\n          checkedIcon: checkedIcon,\n          style: {\n            marginRight: 20\n          },\n          checked: selected\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 25\n        }, this), option.tagName + \"   מהשיר   \" + option.songName]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 21\n      }, this),\n      style: {\n        width: 1200\n      },\n      renderInput: params =>\n      /*#__PURE__*/\n      //dir=\"rtl\" ; it breaks the X to left, outside...\n      _jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Icon, {\n          style: {\n            width: \"250px\"\n          },\n          width: \"40px\",\n          icon: magnifyingGlass\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(TextField, { ...params,\n          variant: \"outlined\",\n          label: \"\",\n          placeholder: \"\\u05D4\\u05E7\\u05DC\\u05D3 \\u05DE\\u05D9\\u05DC\\u05D4 \\u05DB\\u05D3\\u05D9 \\u05DC\\u05D0\\u05EA\\u05E8 \\u05D0\\u05EA \\u05D4\\u05EA\\u05D2\\u05D9\\u05EA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n      onClick: downloadAllSongs,\n      style: {\n        color: \"white\",\n        width: \"110px\"\n      },\n      width: \"70px\",\n      children: [\" \", /*#__PURE__*/_jsxDEV(SystemUpdateAltIcon, {\n        style: {\n          color: \"white\",\n          width: \"110px\"\n        },\n        width: \"70px\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 111\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 221,\n    columnNumber: 9\n  }, this);\n}, \"Hmdl4N0G/x6A8c+vrwP9y3VFq1g=\"));","map":{"version":3,"sources":["C:/git/BLD.REACT.JS/src/CheckboxesTags.js"],"names":["React","useState","useEffect","Checkbox","TextField","Autocomplete","IconButton","Icon","InlineIcon","CheckBoxOutlineBlankIcon","magnifyingGlass","CheckBoxIcon","SystemUpdateAltIcon","connect","icon","checkedIcon","mapStateToProps","state","userId","UserId","comment","Comment","songList","SongList","CheckboxesTags","props","severity","setSeverity","alertContent","setAlertContent","text","setText","errorPlay","setErrorPlay","songsIdArray","setSongsIdArray","songsArray","setSongsArray","songContect","songName","showError","setTimeout","bind","filterTag","window","Store","getState","length","cloneTagList","filter","rows","isPermit","newTagListToShow","map","o","i","tags","neatTags","songId","points","pointsTags","cloneTagListToShow","nameSong","idSong","tagArr","tagPoints","j","concat","tagName","cloneTagListToShow1","sort","a","b","parseFloat","setTagsArray","downloadAllSongs","e","downloadTxtFile","currentSongAll","p","currentSong","element","document","createElement","songi","href","URL","createObjectURL","Blob","type","download","body","appendChild","click","tagsArray","upgrowTagPointReal","v","currentTarget","firstElementChild","innerText","substring","to","indexOf","to2","from2","lastIndexOf","tagush","songush","line","upgrowTagPoint","cloneArray","cloneSongsId","newId","tagName_","songId_","json4","JSON","stringify","fetch","method","headers","then","res","json","err","display","justifyContent","flexDirection","flexWrap","color","target","checked","cancelable","console","log","option","selected","textAlign","marginRight","width","params"],"mappings":";;;AAAA;AACA,SAASA,KAAT,EAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,QAAP,MAAqB,4BAArB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,YAAP,MAAyB,+BAAzB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,SAASC,IAAT,EAAeC,UAAf,QAAiC,gBAAjC;AACA,OAAOC,wBAAP,MAAqC,yCAArC;AACA,OAAOC,eAAP,MAA4B,oCAA5B;AACA,OAAOC,YAAP,MAAyB,6BAAzB;AACA,OAAOC,mBAAP,MAAgC,oCAAhC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAO,sBAAP;;;AACA,MAAMC,IAAI,gBAAG,QAAC,wBAAD;AAA0B,EAAA,QAAQ,EAAC;AAAnC;AAAA;AAAA;AAAA;AAAA,QAAb;;AACA,MAAMC,WAAW,gBAAG,QAAC,YAAD;AAAc,EAAA,QAAQ,EAAC;AAAvB;AAAA;AAAA;AAAA;AAAA,QAApB;;AAGA,SAASC,eAAT,CAAyBC,KAAzB,EAAgC;AAC5B,SAAO;AACHC,IAAAA,MAAM,EAAED,KAAK,CAACE,MADX;AAEHC,IAAAA,OAAO,EAAEH,KAAK,CAACI,OAFZ;AAGHC,IAAAA,QAAQ,EAAEL,KAAK,CAACM;AAHb,GAAP;AAKH;;AAGD,eAAeV,OAAO,CAACG,eAAD,CAAP,IAAyB,SAASQ,cAAT,CAAwBC,KAAxB,EAA+B;AAAA;;AAAC;AACpE,QAAM;AAAEP,IAAAA,MAAF;AAAUE,IAAAA,OAAV;AAAmBE,IAAAA,QAAnB;AAA6BI,IAAAA,QAA7B;AAAuCC,IAAAA,WAAvC;AAAoDC,IAAAA,YAApD;AAAkEC,IAAAA,eAAlE;AAAmFC,IAAAA,IAAnF;AAAyFC,IAAAA,OAAzF;AAAkGC,IAAAA,SAAlG;AAA6GC,IAAAA;AAA7G,MAA8HR,KAApI;AACA;AAAC;AAA4B;AAC7B,QAAM,CAACS,YAAD,EAAeC,eAAf,IAAkClC,QAAQ,CAAC,EAAD,CAAhD,CAHmE,CAInE;;AAEA,QAAM,CAACmC,UAAD,EAAaC,aAAb,IAA8BpC,QAAQ,CAAC,CAEzC;AAAEqC,IAAAA,WAAW,EAAE,mBAAf;AAAoCC,IAAAA,QAAQ,EAAE;AAA9C,GAFyC,CAAD,CAA5C;AAIA;AAAC;AAA0C;;AAC3C,WAASC,SAAT,GAAqB;AAEjB;AACAC,IAAAA,UAAU,CAAC,YAAY;AACnBR,MAAAA,YAAY,CAAC,MAAD,CAAZ;AAEH,KAHU,CAGTS,IAHS,CAGJ,IAHI,CAAD,EAGI,IAHJ,CAAV;AAKAT,IAAAA,YAAY,CAAC,EAAD,CAAZ;AACH;;AACD;AAAC;AAAgE;;AACjE,WAASU,SAAT,GAAqB;AACjB;;AACA,QAAIC,MAAM,CAACC,KAAP,CAAaC,QAAb,GAAwBvB,QAAxB,CAAiCwB,MAAjC,GAA0C,CAA9C,EAAiD;AAM7C,UAAIC,YAAY,GACZJ,MAAM,CAACC,KAAP,CAAaC,QAAb,GAAwBvB,QAAxB,CAAiC0B,MAAjC,CACIC,IAAI,IAECA,IAAI,CAAChC,MAAL,IAAeA,MAAf,IAAyBE,OAAO,IAAI,SAArC,IACC,CAAC8B,IAAI,CAACC,QAAL,IAAiB,IAAjB,IAAyBD,IAAI,CAAChC,MAAL,IAAeA,MAAzC,KAAoDE,OAAO,IAAI,KAJxE,CADJ;AAUA,UAAIgC,gBAAgB,GAAGJ,YAAY,CAACK,GAAb,CAAiB,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AACpD,eAAO;AAAEC,UAAAA,IAAI,EAAEF,CAAC,CAACG,QAAV;AAAoBlB,UAAAA,QAAQ,EAAEe,CAAC,CAACf,QAAhC;AAA0CmB,UAAAA,MAAM,EAAEJ,CAAC,CAACI,MAApD;AAA4DC,UAAAA,MAAM,EAAEL,CAAC,CAACM;AAAtE,SAAP;AACH,OAFsB,CAAvB;AAIA;AAAC;AAA6C;AAE9C,UAAIC,kBAAkB,GAAG,EAAzB;;AACA,WAAK,IAAIN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,gBAAgB,CAACL,MAArC,EAA6CQ,CAAC,EAA9C,EAAkD;AAE9C,YAAIO,QAAQ,GAAGV,gBAAgB,CAACG,CAAD,CAAhB,CAAoBhB,QAAnC;AACA,YAAIwB,MAAM,GAAGX,gBAAgB,CAACG,CAAD,CAAhB,CAAoBG,MAAjC;AACA,YAAIM,MAAM,GAAGZ,gBAAgB,CAACG,CAAD,CAAhB,CAAoBC,IAAjC;AACA,YAAIS,SAAS,GAAGb,gBAAgB,CAACG,CAAD,CAAhB,CAAoBI,MAApC;;AACA,aAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,MAAM,CAACjB,MAA3B,EAAmCmB,CAAC,EAApC,EAAwC;AAEpCL,UAAAA,kBAAkB,GAAGA,kBAAkB,CAACM,MAAnB,CAA0B;AAC3C5B,YAAAA,QAAQ,EAAEuB,QADiC;AAE3CJ,YAAAA,MAAM,EAAEK,MAFmC;AAG3CK,YAAAA,OAAO,EAAEJ,MAAM,CAACE,CAAD,CAH4B;AAI3CP,YAAAA,MAAM,EAAEM,SAAS,CAACC,CAAD;AAJ0B,WAA1B,CAArB;AAOH;AAGJ;;AAGD,UAAIG,mBAAmB,GAAGR,kBAAkB,CAACS,IAAnB,CAAwB,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC9D,YAAID,CAAC,CAACH,OAAF,GAAYI,CAAC,CAACJ,OAAlB,EAA2B,OAAOK,UAAU,CAACD,CAAC,CAACb,MAAH,CAAV,GAAuBc,UAAU,CAACF,CAAC,CAACZ,MAAH,CAAjC,IAA+C,CAAC,CAAvD;AAC3B,YAAIY,CAAC,CAACH,OAAF,GAAYI,CAAC,CAACJ,OAAlB,EAA2B,OAAOK,UAAU,CAACD,CAAC,CAACb,MAAH,CAAV,GAAuBc,UAAU,CAACF,CAAC,CAACZ,MAAH,CAAjC,IAA+C,CAAtD;AAC3B,eAAOc,UAAU,CAACD,CAAC,CAACb,MAAH,CAAV,GAAuBc,UAAU,CAACF,CAAC,CAACZ,MAAH,CAAjC,IAA+C,CAAtD,CAH8D,CAI9D;AACH,OALyB,CAA1B;AAMA;AACAe,MAAAA,YAAY,CAACL,mBAAD,CAAZ;AACH,KApDD,MAoDO;AACH5B,MAAAA,UAAU,CAACE,SAAD,EAAY,IAAZ,CAAV,CADG,CAC0B;AAChC;AAEJ;;AAEDzC,EAAAA,SAAS,CAAC,MAAM;AACZyC,IAAAA,SAAS;AACZ,GAFQ,EAGL,CAACvB,OAAD,CAHK,CAAT,CAlFmE,CAyFnE;;AACA,WAASuD,gBAAT,CAA0BC,CAA1B,EAA6B;AACzB,SAAK,IAAIrB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGrB,YAAY,CAACa,MAAjC,EAAyCQ,CAAC,EAA1C,EAA8C;AAC1CsB,MAAAA,eAAe,CAACD,CAAD,EAAI1C,YAAY,CAACqB,CAAD,CAAhB,CAAf;AACH;AAEJ,GA/FkE,CAgGnE;;;AACA,WAASsB,eAAT,CAAyBD,CAAzB,EAA4BrB,CAA5B,EAA+B;AAE3B,QAAIuB,cAAc,GAAGxD,QAAQ,CAAC2B,MAAT,CAAgB8B,CAAC,IAAIA,CAAC,CAACrB,MAAF,IAAYH,CAAjC,CAArB;;AACA,QAAIuB,cAAc,CAAC/B,MAAf,IAAyB,CAA7B,EAAgC;AAC5B,UAAIiC,WAAW,GAAGF,cAAc,CAAC,CAAD,CAAhC;AACA,UAAIrB,QAAQ,GAAGuB,WAAW,CAACvB,QAA3B;AACA,YAAMwB,OAAO,GAAGC,QAAQ,CAACC,aAAT,CAAuB,GAAvB,CAAhB;AAEA,UAAIC,KAAK,GAAG,IAAZ;;AACA,WAAK,IAAI7B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGE,QAAQ,CAACV,MAA7B,EAAqCQ,CAAC,EAAtC,EAA0C;AACtC6B,QAAAA,KAAK,GAAGA,KAAK,GAAG3B,QAAQ,CAACF,CAAD,CAAhB,GAAsB,IAA9B;AACH;;AAED0B,MAAAA,OAAO,CAACI,IAAR,GAAeC,GAAG,CAACC,eAAJ,CAAoB,IAAIC,IAAJ,CAAS,CAACJ,KAAD,CAAT,EAC/B;AAAEK,QAAAA,IAAI,EAAE;AAAR,OAD+B,CAApB,CAAf;AAGAR,MAAAA,OAAO,CAACS,QAAR,GAAmBV,WAAW,CAACzC,QAAZ,GAAuB,MAA1C;AACA2C,MAAAA,QAAQ,CAACS,IAAT,CAAcC,WAAd,CAA0BX,OAA1B;AACAA,MAAAA,OAAO,CAACY,KAAR;AACH;AAKJ;;AAED;AAAC;AAAiC;AAClC,QAAM,CAACC,SAAD,EAAYpB,YAAZ,IAA4BzE,QAAQ,CAAC,EAAD,CAA1C,CA5HmE,CA8HnE;;AACAC,EAAAA,SAAS,CAAC,YAAY;AAElByC,IAAAA,SAAS;AACT,WAAO,SAAS4B,CAAT,GAAa,CAChB;AACH,KAFD;AAGH,GANQ,EAMN,EANM,CAAT,CA/HmE,CAuInE;;AACA,WAASwB,kBAAT,CAA4BnB,CAA5B,EAA+B;AAC3B;AACA,QAAIoB,CAAC,GAAGpB,CAAC,CAACqB,aAAF,CAAgBC,iBAAhB,CAAkCC,SAA1C;AACAH,IAAAA,CAAC,GAAGA,CAAC,CAACI,SAAF,CAAY,CAAZ,EAAeJ,CAAC,CAACjD,MAAjB,CAAJ,CAH2B,CAGE;;AAC7B,QAAIsD,EAAE,GAAGL,CAAC,CAACM,OAAF,CAAU,aAAV,CAAT;AACA,QAAIC,GAAG,GAAGP,CAAC,CAACjD,MAAZ;AACA,QAAIyD,KAAK,GAAGR,CAAC,CAACS,WAAF,CAAc,aAAd,IAA+B,EAA3C;AACA,QAAIC,MAAM,GAAGV,CAAC,CAACI,SAAF,CAAY,CAAZ,EAAeC,EAAf,CAAb;AAEA,QAAIM,OAAO,GAAGX,CAAC,CAACI,SAAF,CAAYI,KAAZ,EAAmBD,GAAnB,CAAd;AACA,QAAIK,IAAI,GAAGd,SAAS,CAAC7C,MAAV,CAAiBM,CAAC,IAAIA,CAAC,CAACa,OAAF,IAAasC,MAAb,IAAuBnD,CAAC,CAAChB,QAAF,IAAcoE,OAA3D,CAAX;;AACA,QAAIC,IAAI,CAAC7D,MAAL,IAAe,CAAnB,EAAsB;AAElB8D,MAAAA,cAAc,CAACjC,CAAD,EAAIgC,IAAI,CAAC,CAAD,CAAJ,CAAQxC,OAAZ,EAAqBwC,IAAI,CAAC,CAAD,CAAJ,CAAQlD,MAA7B,CAAd;AACA;AACA,UAAIoD,UAAU,GAAG1E,UAAU,CAAC+B,MAAX,CAAkB;AAAET,QAAAA,MAAM,EAAEkD,IAAI,CAAC,CAAD,CAAJ,CAAQlD,MAAlB;AAA0BpB,QAAAA,WAAW,EAAEsE,IAAI,CAAC,CAAD,CAAJ,CAAQtE,WAA/C;AAA4DC,QAAAA,QAAQ,EAAEqE,IAAI,CAAC,CAAD,CAAJ,CAAQrE,QAAR,GAAmB,GAAnB,GAAyBqE,IAAI,CAAC,CAAD,CAAJ,CAAQxC;AAAvG,OAAlB,CAAjB;AACA/B,MAAAA,aAAa,CAACyE,UAAD,CAAb,CALkB,CAMlB;;AAEA,UAAIC,YAAY,GAAG,CAAC,GAAG7E,YAAJ,CAAnB;AACA,UAAI8E,KAAK,GAAGJ,IAAI,CAAC,CAAD,CAAJ,CAAQlD,MAApB;AACAqD,MAAAA,YAAY,GAAGA,YAAY,CAAC5C,MAAb,CAAoB6C,KAApB,CAAf;AACA7E,MAAAA,eAAe,CAAC4E,YAAD,CAAf;AAEH,KAbD,MAcK,CACD;AACH;AAEJ,GArKkE,CAuKnE;;;AACA,WAASF,cAAT,CAAwBjC,CAAxB,EAA2BqC,QAA3B,EAAqCC,OAArC,EAA8C;AAC1C;AACA,QAAIC,KAAK,GAAGC,IAAI,CAACC,SAAL,CAAe;AAAEvF,MAAAA,IAAI,EAAEmF,QAAR;AAAkBvD,MAAAA,MAAM,EAAEwD;AAA1B,KAAf,CAAZ;AAEAI,IAAAA,KAAK,CAAC,gCAAD,EAAmC;AAEpCC,MAAAA,MAAM,EAAE,KAF4B;AAGpCC,MAAAA,OAAO,EAAE;AACL,wBAAgB,kBADX;AAEL,kBAAU;AAFL,OAH2B;AAOpC7B,MAAAA,IAAI,EAAEwB;AAP8B,KAAnC,CAAL,CAUKM,IAVL,CAUUC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAVjB,EAYKF,IAZL,CAYWC,GAAD,IAAS,CACX;AACA;AACH,KAfL,EAgBSE,GAAD,IAAS,CACL;AACH,KAlBT;AAmBH;;AAED,sBACI;AAAK,IAAA,EAAE,EAAC,GAAR;AAAY,IAAA,KAAK,EAAE;AAAEC,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,cAAc,EAAE,cAAnC;AAAmDC,MAAAA,aAAa,EAAE,aAAlE;AAAiFC,MAAAA,QAAQ,EAAE;AAA3F,KAAnB;AAAA,4BAGI,QAAC,YAAD;AACI,MAAA,KAAK,EAAE;AAAEC,QAAAA,KAAK,EAAE,OAAT;AAAkBJ,QAAAA,OAAO,EAAE,MAA3B;AAAmCC,QAAAA,cAAc,EAAE;AAAnD,OADX;AAEI,MAAA,QAAQ,MAFZ,CAII;AAJJ;AAKI,MAAA,QAAQ,EAAGlD,CAAD,IAAO;AACb;;AACA,YAAIA,CAAC,CAACsD,MAAF,CAASC,OAAb,EAAsB;AAClB;AACApC,UAAAA,kBAAkB,CAACnB,CAAD,CAAlB;AACH,SAHD,MAIK;AACD;;AACA,cAAIA,CAAC,CAACwD,UAAF,IAAgB,IAApB,EAA0B;AACtB;AAEAzG,YAAAA,WAAW,CAAC,SAAD,CAAX;AACAE,YAAAA,eAAe,CAAC,8CAAD,CAAf;AAEAW,YAAAA,SAAS;AACZ;AAEJ;;AACD,YAAIoC,CAAC,CAACsD,MAAF,CAASC,OAAb,EACIE,OAAO,CAACC,GAAR,CAAY,QAAZ,EADJ,KAEK,CACD;AACH;AAEJ,OA7BL,CA+BI;AA/BJ;AAiCI,MAAA,EAAE,EAAC,sBAjCP,CAkCI;AAlCJ;AAmCI,MAAA,OAAO,EAAExC,SAnCb;AAoCI,MAAA,oBAAoB,MApCxB;AAqCI,MAAA,cAAc,EAAGyC,MAAD,IAAYA,MAAM,CAAChG,QArCvC;AAsCI,MAAA,YAAY,EAAE,CAACgG,MAAD,EAAS;AAAEC,QAAAA;AAAF,OAAT,kBAEV;AAAA,gCAEI,QAAC,QAAD;AACI,UAAA,GAAG,EAAC,KADR;AAEI,UAAA,KAAK,EAAE;AAAEC,YAAAA,SAAS,EAAE;AAAb,WAFX;AAGI,UAAA,IAAI,EAAE3H,IAHV;AAII,UAAA,WAAW,EAAEC,WAJjB;AAKI,UAAA,KAAK,EAAE;AAAE2H,YAAAA,WAAW,EAAE;AAAf,WALX;AAMI,UAAA,OAAO,EAAEF;AANb;AAAA;AAAA;AAAA;AAAA,gBAFJ,EAUKD,MAAM,CAACnE,OAAP,GAAiB,aAAjB,GAAiCmE,MAAM,CAAChG,QAV7C;AAAA;AAAA;AAAA;AAAA;AAAA,cAxCR;AAqDI,MAAA,KAAK,EAAE;AAAEoG,QAAAA,KAAK,EAAE;AAAT,OArDX;AAsDI,MAAA,WAAW,EAAGC,MAAD;AAAA;AAET;AAEA;AAAA,gCAEI,QAAC,IAAD;AAAM,UAAA,KAAK,EAAE;AAAED,YAAAA,KAAK,EAAE;AAAT,WAAb;AAAiC,UAAA,KAAK,EAAC,MAAvC;AAA8C,UAAA,IAAI,EAAEjI;AAApD;AAAA;AAAA;AAAA;AAAA,gBAFJ,eAGI,QAAC,SAAD,OAAekI,MAAf;AAAuB,UAAA,OAAO,EAAC,UAA/B;AACI,UAAA,KAAK,EAAC,EADV;AACa,UAAA,WAAW,EAAC;AADzB;AAAA;AAAA;AAAA;AAAA,gBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AA1DR;AAAA;AAAA;AAAA;AAAA,YAHJ,eAwEI,QAAC,UAAD;AAAY,MAAA,OAAO,EAAEjE,gBAArB;AAAuC,MAAA,KAAK,EAAE;AAAEsD,QAAAA,KAAK,EAAE,OAAT;AAAkBU,QAAAA,KAAK,EAAE;AAAzB,OAA9C;AAAkF,MAAA,KAAK,EAAC,MAAxF;AAAA,mCAAkG,QAAC,mBAAD;AAAqB,QAAA,KAAK,EAAE;AAAEV,UAAAA,KAAK,EAAE,OAAT;AAAkBU,UAAAA,KAAK,EAAE;AAAzB,SAA5B;AAAgE,QAAA,KAAK,EAAC;AAAtE;AAAA;AAAA;AAAA;AAAA,cAAlG;AAAA;AAAA;AAAA;AAAA;AAAA,YAxEJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AA6EH,CA9Qc,kCAAf","sourcesContent":["//השלמה אוטומאטית לתגיות\r\nimport { React, useState, useEffect } from 'react';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Autocomplete from '@material-ui/lab/Autocomplete';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport { Icon, InlineIcon } from '@iconify/react';\r\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\r\nimport magnifyingGlass from '@iconify-icons/oi/magnifying-glass';\r\nimport CheckBoxIcon from '@material-ui/icons/CheckBox';\r\nimport SystemUpdateAltIcon from '@material-ui/icons/SystemUpdateAlt';\r\nimport { connect } from 'react-redux';\r\nimport './CheckboxesTags.css';\r\nconst icon = <CheckBoxOutlineBlankIcon fontSize=\"small\" />;\r\nconst checkedIcon = <CheckBoxIcon fontSize=\"small\" />;\r\n\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        userId: state.UserId,\r\n        comment: state.Comment,\r\n        songList: state.SongList\r\n    };\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(function CheckboxesTags(props) {//שטח התגיות + אפשרויות \r\n    const { userId, comment, songList, severity, setSeverity, alertContent, setAlertContent, text, setText, errorPlay, setErrorPlay } = props;\r\n    {/* רשימת כל מזהי השירים */ }\r\n    const [songsIdArray, setSongsIdArray] = useState([]);\r\n    //קבלת כל השירים המורשים מתוך המאגר\r\n\r\n    const [songsArray, setSongsArray] = useState([\r\n\r\n        { songContect: \"thank to hashem 7\", songName: \"a6\" }\r\n    ]);\r\n    {/* פונקציה המציגה הודעה במשך 10 שניות */ }\r\n    function showError() {\r\n\r\n        //למשך 10 שניות הצגת ההודעה\r\n        setTimeout(function () {\r\n            setErrorPlay(\"none\");\r\n\r\n        }.bind(this), 5000);\r\n\r\n        setErrorPlay(\"\");\r\n    }\r\n    {/* פילטור השירים (פרטי או גלובלי) לתוך רשימת התגיות כתגיות  */ }\r\n    function filterTag() {\r\n        debugger;\r\n        if (window.Store.getState().SongList.length > 0) {\r\n\r\n\r\n\r\n\r\n\r\n            var cloneTagList = (\r\n                window.Store.getState().SongList.filter(\r\n                    rows =>\r\n                    (\r\n                        (rows.userId == userId && comment == \"private\") ||\r\n                        ((rows.isPermit == true || rows.userId == userId) && comment == \"all\")\r\n                    )\r\n                )\r\n            );\r\n\r\n            var newTagListToShow = cloneTagList.map(function (o, i) {\r\n                return { tags: o.neatTags, songName: o.songName, songId: o.songId, points: o.pointsTags };\r\n            });\r\n\r\n            {/* מפוי השירים מתוך רשימת השירים, כתגיות */ }\r\n\r\n            var cloneTagListToShow = [];\r\n            for (var i = 0; i < newTagListToShow.length; i++) {\r\n\r\n                var nameSong = newTagListToShow[i].songName;\r\n                var idSong = newTagListToShow[i].songId;\r\n                var tagArr = newTagListToShow[i].tags;\r\n                var tagPoints = newTagListToShow[i].points;\r\n                for (var j = 0; j < tagArr.length; j++) {\r\n\r\n                    cloneTagListToShow = cloneTagListToShow.concat({\r\n                        songName: nameSong,\r\n                        songId: idSong,\r\n                        tagName: tagArr[j],\r\n                        points: tagPoints[j]\r\n                    });\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n\r\n            var cloneTagListToShow1 = cloneTagListToShow.sort(function (a, b) {\r\n                if (a.tagName < b.tagName) return parseFloat(b.points) - parseFloat(a.points) || -1;\r\n                if (a.tagName > b.tagName) return parseFloat(b.points) - parseFloat(a.points) || 1;\r\n                return parseFloat(b.points) - parseFloat(a.points) || 0;\r\n                //מיון לפי נקודות ואח''כ לפי א''ב\r\n            });\r\n            debugger;\r\n            setTagsArray(cloneTagListToShow1);\r\n        } else {\r\n            setTimeout(filterTag, 1000); // try again in 1000 milliseconds (1 second)\r\n        }\r\n\r\n    }\r\n\r\n    useEffect(() => {\r\n        filterTag();\r\n    },\r\n        [comment]\r\n    );\r\n\r\n\r\n    // פונקציה המזמנת את פונקציה הורדת השיר\r\n    function downloadAllSongs(e) {\r\n        for (var i = 0; i < songsIdArray.length; i++) {\r\n            downloadTxtFile(e, songsIdArray[i]);\r\n        }\r\n\r\n    }\r\n    //מתוך כל התגיות שנבחרו עם שם שיר והורדת שורה מידי תגית TXT פונקציה להורדת קובץ\r\n    function downloadTxtFile(e, i) {\r\n\r\n        var currentSongAll = songList.filter(p => p.songId == i);\r\n        if (currentSongAll.length == 1) {\r\n            var currentSong = currentSongAll[0];\r\n            var neatTags = currentSong.neatTags;\r\n            const element = document.createElement(\"a\");\r\n\r\n            var songi = \"\\n\";\r\n            for (var i = 0; i < neatTags.length; i++) {\r\n                songi = songi + neatTags[i] + \"\\n\";\r\n            }\r\n\r\n            element.href = URL.createObjectURL(new Blob([songi],\r\n                { type: 'text/plain;charset=utf-8' }));\r\n\r\n            element.download = currentSong.songName + \".txt\";\r\n            document.body.appendChild(element);\r\n            element.click();\r\n        }\r\n\r\n\r\n\r\n\r\n    }\r\n\r\n    {/* לצורך העלאת נקודות התגיות */ }\r\n    const [tagsArray, setTagsArray] = useState([]);\r\n\r\n    //STOREלראשונה מתוך התגיות ב COMBOBOXקריאה למלוי ה\r\n    useEffect(function () {\r\n\r\n        filterTag();\r\n        return function a() {\r\n            // פונקציה הקוראת כאשר מתבצעת יציאה מהקומפוננטה: alert(\" bye bye \");\r\n        }\r\n    }, [])\r\n\r\n    //לפי התגית הנלחצת DB פונקציה הקוראת להעלאת הנקודות ב\r\n    function upgrowTagPointReal(e) {\r\n        debugger;\r\n        var v = e.currentTarget.firstElementChild.innerText;\r\n        v = v.substring(0, v.length);//?\r\n        var to = v.indexOf(\"   מהשיר   \");\r\n        var to2 = v.length;\r\n        var from2 = v.lastIndexOf(\"   מהשיר   \") + 11;\r\n        var tagush = v.substring(0, to);\r\n\r\n        var songush = v.substring(from2, to2);\r\n        var line = tagsArray.filter(i => i.tagName == tagush && i.songName == songush);\r\n        if (line.length != 0) {\r\n\r\n            upgrowTagPoint(e, line[0].tagName, line[0].songId);\r\n            debugger;\r\n            var cloneArray = songsArray.concat({ songId: line[0].songId, songContect: line[0].songContect, songName: line[0].songName + \" \" + line[0].tagName });\r\n            setSongsArray(cloneArray);\r\n            //  alert(\" התגית:  \" + tagush + \", מהשיר: \" + songush);\r\n\r\n            var cloneSongsId = [...songsIdArray];\r\n            var newId = line[0].songId;\r\n            cloneSongsId = cloneSongsId.concat(newId);\r\n            setSongsIdArray(cloneSongsId);\r\n\r\n        }\r\n        else {\r\n            // alert(\" השיר לא נמצא \");\r\n        }\r\n\r\n    }\r\n\r\n    // DBפונקציה להעלאת הנקודות ב\r\n    function upgrowTagPoint(e, tagName_, songId_) {\r\n        debugger;\r\n        var json4 = JSON.stringify({ text: tagName_, songId: songId_ });\r\n\r\n        fetch(\"http://localhost:62135/api/Tag\", {\r\n\r\n            method: \"PUT\",\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Accept': 'application/json'\r\n            },\r\n            body: json4\r\n        })\r\n\r\n            .then(res => res.json())\r\n\r\n            .then((res) => {\r\n                // debugger;\r\n                // alert(res.Data);\r\n            },\r\n                (err) => {\r\n                    //   debugger;\r\n                })\r\n    }\r\n\r\n    return (\r\n        <div id=\"a\" style={{ display: \"flex\", justifyContent: \"space-around\", flexDirection: \"row-reverse\", flexWrap: \"wrap\" }}>\r\n\r\n            {/* השלמה אוטומאית לתגיות + קומבובוקס */}\r\n            <Autocomplete\r\n                style={{ color: \"white\", display: \"flex\", justifyContent: \"space-between\" }}\r\n                multiple\r\n               \r\n                // אך לא עובדת בעת הקלדת אנטר במקלדת 🎃 DB פונקציה הרצה רק בזמן לחיצת עכבר על התגית, ומעלה את ערכי הנקודות ב\r\n                onChange={(e) => {\r\n                    debugger;\r\n                    if (e.target.checked) {\r\n                        debugger;\r\n                        upgrowTagPointReal(e)\r\n                    }\r\n                    else {\r\n                        debugger;\r\n                        if (e.cancelable == true) {\r\n                            // alert('on download it will be showed, sorry.');\r\n\r\n                            setSeverity(\"warning\");\r\n                            setAlertContent(\"בהורדת כלל השירים הנבחרים, גם שיר זה יופיע. \");\r\n\r\n                            showError()\r\n                        }\r\n\r\n                    }\r\n                    if (e.target.checked)\r\n                        console.log(\" good \");\r\n                    else {\r\n                        //alert(\" sorry, it isn't an event! \");\r\n                    }\r\n\r\n                }}\r\n\r\n                //הלחיצה היא על תיבת הטקסט, עליה חל האנטר ולא על הנבחר ספייציפי...\r\n\r\n                id=\"checkboxes-tags-demo\"\r\n                // מיון התגיות לפי שמן ואחר כך לפי מספר הנקודות\r\n                options={tagsArray}\r\n                disableCloseOnSelect\r\n                getOptionLabel={(option) => option.songName}\r\n                renderOption={(option, { selected }) => (\r\n\r\n                    <div>\r\n\r\n                        <Checkbox\r\n                            dir=\"rtl\"\r\n                            style={{ textAlign: 'right' }}\r\n                            icon={icon}\r\n                            checkedIcon={checkedIcon}\r\n                            style={{ marginRight: 20 }}\r\n                            checked={selected}\r\n                        />\r\n                        {option.tagName + \"   מהשיר   \" + option.songName}\r\n                    </div>)\r\n                }\r\n                style={{ width: 1200 }}\r\n                renderInput={(params) => (\r\n\r\n                    //dir=\"rtl\" ; it breaks the X to left, outside...\r\n\r\n                    <div>\r\n                        {/* תגית זכוכית המגדלת */}\r\n                        <Icon style={{ width: \"250px\" }} width=\"40px\" icon={magnifyingGlass} />\r\n                        <TextField {...params} variant=\"outlined\"\r\n                            label=\"\" placeholder=\"הקלד מילה כדי לאתר את התגית\" />\r\n\r\n                    </div>\r\n\r\n                )}\r\n            />\r\n            {/* תגית ההורדה */}\r\n            <IconButton onClick={downloadAllSongs} style={{ color: \"white\", width: \"110px\" }} width=\"70px\"  > <SystemUpdateAltIcon style={{ color: \"white\", width: \"110px\" }} width=\"70px\" ></SystemUpdateAltIcon></IconButton>\r\n\r\n        </div>\r\n    );\r\n})"]},"metadata":{},"sourceType":"module"}