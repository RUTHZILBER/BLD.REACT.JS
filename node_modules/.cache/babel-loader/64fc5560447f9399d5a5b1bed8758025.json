{"ast":null,"code":"var _jsxFileName = \"C:\\\\git\\\\BLD.REACT.JS\\\\src\\\\UploadFiles.js\",\n    _s = $RefreshSig$();\n\n//הוספת שיר חדש למאגר למאגר\nimport React, { Component, useState, useEffect } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport Backdrop from '@material-ui/core/Backdrop';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\nimport './UploadFiles.css';\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from 'react-redux';\nimport { createBrowserHistory } from \"history\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction mapStateToProps(state) {\n  return {\n    userId: state.UserId,\n    userName: state.UserName,\n    firstName: state.FirstName,\n    lastName: state.LastName,\n    email: state.Email,\n    password: state.Password,\n    nothingTime: state.NotingTime,\n    comment: state.Comment,\n    songList: state.SongList\n  };\n}\n\nexport default withRouter(connect(mapStateToProps)(_s(function UploadFiles(props) {\n  _s();\n\n  const {\n    history,\n    alertContent,\n    dispatch,\n    setAlertContent,\n    errorPlay,\n    setErrorPlay,\n    severity,\n    setSeverity,\n    songList\n  } = props;\n  const useStyles = makeStyles(theme => ({\n    backdrop: {\n      zIndex: theme.zIndex.drawer + 1,\n      color: '#fff'\n    }\n  }));\n  const classes = useStyles();\n  const [isDisable, setIsDisable] = useState(false);\n  const [songsArray, setSongsArray] = useState([{\n    SongId: \"\",\n    SongName: \"\",\n    SongContect: \"\",\n    UserId: \"\",\n    IsPermit: \"true\"\n  }, {\n    SongId: \"\",\n    SongName: \"\",\n    SongContect: \"\",\n    UserId: \"1\",\n    IsPermit: \"\"\n  }]);\n  const [open1, setOpen1] = useState(false);\n\n  const handleClose1 = () => {\n    setOpen1(false);\n  };\n\n  const handleToggle1 = () => {\n    setOpen1(!open1);\n  };\n\n  const Transition = /*#__PURE__*/React.forwardRef(function Transition(props, ref) {\n    return /*#__PURE__*/_jsxDEV(Slide, {\n      direction: \"up\",\n      ref: ref,\n      ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 12\n    }, this);\n  });\n  const [open, setOpen] = useState(false);\n  const [isPermition, setIsPermition] = useState(false); //האם השירים שהוא מעלה כרגע מורשים או לא\n\n  async function updateSongArray(e, item) {\n    var cloneArray = [...songsArray];\n    cloneArray = cloneArray.concat(e.target.result);\n    setSongsArray(cloneArray);\n  }\n\n  const [event1, setEvent1] = useState(null);\n\n  const handleClickOpen = e => {\n    setOpen(true);\n    setIndex(\"200\");\n    setEvent1(e);\n  };\n\n  const handleClose = () => {\n    setIndex(\"-20000\");\n    setOpen(false);\n  };\n\n  function insertSelectedSongsAndInvestigration(status) {\n    handleToggle1();\n    var files1 = event1.target.files;\n    var listOfSongConcat = [];\n    const files = files1;\n    var numberOfFiles = files.length;\n    var p = 0;\n    this.setIsDisable(true); //  useEffect(() => {  }, []);\n\n    Object.keys(files).forEach(i => {\n      const file = files[i];\n      const reader = new FileReader();\n\n      reader.onload = event1 => {\n        alert(isDisable);\n        updateSongArray(event1);\n        var obj = {};\n        obj[\"SongContect\"] = event1.target.result;\n        obj[\"UserId\"] = window.Store.getState().UserId;\n        obj[\"IsPermit\"] = status;\n        listOfSongConcat.push(obj);\n\n        if (listOfSongConcat.length == numberOfFiles) //הכנסת השירים למסד הנתונים\n          {\n            var k = 0;\n\n            for (k = k; k < listOfSongConcat.length; k++) {\n              var json4 = JSON.stringify(listOfSongConcat[k]);\n              fetch(\"http://localhost:62135/api/values/addSong\", {\n                method: \"post\",\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: json4\n              }).then(res => res.json()).then(res => {\n                debugger;\n\n                if (res.Status == true) {\n                  setSeverity(\"success\");\n                  setAlertContent(res.Message + \" השיר יהא זמין להורדה ולצפיה מהכניסה הבאה לאתר .  \");\n                  showError();\n                  p = p + 1;\n\n                  if (p == numberOfFiles) {\n                    handleClose1();\n                  }\n\n                  var thisSong = res.Data;\n                  var newSong = {\n                    songId: thisSong.songId,\n                    songName: thisSong.songName,\n                    neatTags: thisSong.neatTags,\n                    pointsTags: thisSong.pointsTags,\n                    isPermit: thisSong.isPermit,\n                    tag1: thisSong.tag1,\n                    tag2: thisSong.tag2,\n                    tag3: thisSong.tag3,\n                    userId: thisSong.userId,\n                    userName: thisSong.userName // עידכון השיר בטבלה מיד לאחר שמעלים אותו\n                    // מסובך מאד, כי הוספת השיר לא מביאה את השיר ואת תגיותיו והנקודות. בסי שארפ כדאי לשנות. ?\n\n                  };\n                  debugger;\n                  var cloneSongList = songList;\n                  cloneSongList = cloneSongList.concat(newSong);\n                  dispatch({\n                    type: 'SET_SONG_LIST',\n                    payload: cloneSongList\n                  });\n                } else {\n                  setSeverity(\"error\");\n                  setAlertContent(res.Message);\n                  showError(); // alert(\"failed\");\n\n                  p = p + 1;\n\n                  if (p == numberOfFiles) {\n                    handleClose1();\n                  }\n                }\n              }, err => {\n                setSeverity(\"error\");\n                showError(\" שגיאה כללית. נסה שנית \");\n                handleClose1();\n              });\n            }\n          }\n      };\n\n      reader.readAsText(file);\n    });\n    setIndex(\"-300\");\n    debugger; //appHistory.go(0);//is is refresh this page?, maybe: 0\n\n    alert(isDisable);\n    this.setIsDisable(false); // useEffect(() => {  }, [])\n\n    alert(isDisable);\n  }\n\n  function callSetIsDisable() {\n    setIsDisable(false);\n  }\n\n  const [index, setIndex] = useState(\"20\");\n\n  function showError() {\n    //למשך 10 שניות הצגת ההודעה\n    setTimeout(function () {\n      setErrorPlay(\"none\");\n    }.bind(this), 5000);\n    setErrorPlay(\"\");\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"upload\",\n    children: [/*#__PURE__*/_jsxDEV(Backdrop, {\n      className: classes.backdrop,\n      open: open1,\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n        color: \"inherit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog //style={{position:\"fixed\", zIndex: index }} \n    , {\n      dir: \"rtl\",\n      open: open //TransitionComponent={Transition}\n      //keepMounted\n      ,\n      onClose: handleClose,\n      \"aria-labelledby\": \"alert-dialog-slide-title\",\n      \"aria-describedby\": \"alert-dialog-slide-description\",\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        id: \"alert-dialog-slide-title\",\n        children: \"בקשת הסכמת הלקוח לשתף את השיר במאגר\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n          id: \"alert-dialog-slide-description\",\n          children: \"\\u05E9\\u05DC\\u05D5\\u05DD. \\u05D4\\u05D0\\u05DD \\u05D1\\u05E8\\u05E6\\u05D5\\u05E0\\u05DA \\u05DC\\u05D0\\u05E9\\u05E8 \\u05D0\\u05EA \\u05E9\\u05D9\\u05EA\\u05D5\\u05E3 \\u05D4\\u05E9\\u05D9\\u05E8 \\u05D1\\u05DE\\u05D0\\u05D2\\u05E8 \\u05D4\\u05D2\\u05DC\\u05D5\\u05D1\\u05DC\\u05D9 ? \\u05D0\\u05DD \\u05D4\\u05D9\\u05E0\\u05DA \\u05DE\\u05D0\\u05E9\\u05E8, \\u05D0\\u05DC\\u05D2\\u05D5\\u05E8\\u05D9\\u05EA\\u05DD \\u05D4\\u05E9\\u05D9\\u05D5\\u05DD \\u05D9\\u05D4\\u05D9\\u05D4 \\u05DE\\u05D3\\u05D5\\u05D9\\u05E7, \\u05D0\\u05DE\\u05D9\\u05DF \\u05D5\\u05E0\\u05DB\\u05D5\\u05DF \\u05D9\\u05D5\\u05EA\\u05E8!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            handleClose();\n            insertSelectedSongsAndInvestigration(false);\n          },\n          color: \"primary\",\n          children: \"\\u05D0\\u05E0\\u05D9 \\u05DE\\u05D5\\u05D7\\u05D4 \\u05E2\\u05DC \\u05DB\\u05DA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            handleClose();\n            insertSelectedSongsAndInvestigration(true);\n          },\n          color: \"primary\",\n          children: \"\\u05D1\\u05D4\\u05D7\\u05DC\\u05D8!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"button\",\n      style: {\n        backgroundColor: \"white\"\n      },\n      className: \"uploadButton\",\n      width: \"20px \",\n      value: \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      onChange: e => {\n        handleClickOpen(e);\n      },\n      type: \"file\",\n      disabled: isDisable,\n      multiple: true,\n      name: \"upload\",\n      accept: \".txt\",\n      id: \"fileUpload\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 229,\n    columnNumber: 5\n  }, this);\n}, \"7BlJq2NMf7vl751Zgu1h7eCZius=\", false, function () {\n  return [useStyles];\n})));","map":{"version":3,"sources":["C:/git/BLD.REACT.JS/src/UploadFiles.js"],"names":["React","Component","useState","useEffect","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Slide","Backdrop","CircularProgress","makeStyles","withRouter","connect","createBrowserHistory","mapStateToProps","state","userId","UserId","userName","UserName","firstName","FirstName","lastName","LastName","email","Email","password","Password","nothingTime","NotingTime","comment","Comment","songList","SongList","UploadFiles","props","history","alertContent","dispatch","setAlertContent","errorPlay","setErrorPlay","severity","setSeverity","useStyles","theme","backdrop","zIndex","drawer","color","classes","isDisable","setIsDisable","songsArray","setSongsArray","SongId","SongName","SongContect","IsPermit","open1","setOpen1","handleClose1","handleToggle1","Transition","forwardRef","ref","open","setOpen","isPermition","setIsPermition","updateSongArray","e","item","cloneArray","concat","target","result","event1","setEvent1","handleClickOpen","setIndex","handleClose","insertSelectedSongsAndInvestigration","status","files1","files","listOfSongConcat","numberOfFiles","length","p","Object","keys","forEach","i","file","reader","FileReader","onload","alert","obj","window","Store","getState","push","k","json4","JSON","stringify","fetch","method","headers","body","then","res","json","Status","Message","showError","thisSong","Data","newSong","songId","songName","neatTags","pointsTags","isPermit","tag1","tag2","tag3","cloneSongList","type","payload","err","readAsText","callSetIsDisable","index","setTimeout","bind","backgroundColor"],"mappings":"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","sourcesContent":["//הוספת שיר חדש למאגר למאגר\r\nimport React, { Component, useState, useEffect } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Slide from '@material-ui/core/Slide';\r\nimport Backdrop from '@material-ui/core/Backdrop';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport './UploadFiles.css';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { connect } from 'react-redux';\r\nimport { createBrowserHistory } from \"history\";\r\n\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    userId: state.UserId,\r\n    userName: state.UserName,\r\n    firstName: state.FirstName,\r\n    lastName: state.LastName,\r\n    email: state.Email,\r\n    password: state.Password,\r\n    nothingTime: state.NotingTime,\r\n    comment: state.Comment,\r\n    songList:state.SongList\r\n  };\r\n}\r\nexport default withRouter(connect(mapStateToProps)(function UploadFiles(props) {\r\n  const { history, alertContent,dispatch, setAlertContent, errorPlay, setErrorPlay, severity, setSeverity, songList } = props;\r\n  const useStyles = makeStyles((theme) => ({\r\n    backdrop: {\r\n      zIndex: theme.zIndex.drawer + 1,\r\n      color: '#fff',\r\n    },\r\n  }));\r\n\r\n  const classes = useStyles();\r\n  const [isDisable,setIsDisable]=useState(false);\r\n  const [songsArray, setSongsArray] = useState([\r\n    {\r\n      SongId: \"\",\r\n      SongName: \"\",\r\n      SongContect: \"\",\r\n      UserId: \"\",\r\n      IsPermit: \"true\"\r\n    },\r\n    {\r\n      SongId: \"\",\r\n      SongName: \"\",\r\n      SongContect: \"\",\r\n      UserId: \"1\",\r\n      IsPermit: \"\"\r\n    }\r\n  ]);\r\n\r\n\r\n\r\n  const [open1, setOpen1] = useState(false);\r\n\r\n  const handleClose1 = () => {\r\n    setOpen1(false);\r\n  };\r\n\r\n  const handleToggle1 = () => {\r\n    setOpen1(!open1);\r\n  };\r\n\r\n  const Transition = React.forwardRef(function Transition(props, ref) {\r\n    return <Slide direction=\"up\" ref={ref} {...props} />;\r\n  });\r\n\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const [isPermition, setIsPermition] = useState(false);//האם השירים שהוא מעלה כרגע מורשים או לא\r\n\r\n  async function updateSongArray(e, item) {\r\n    var cloneArray = [...songsArray];\r\n    cloneArray = cloneArray.concat(e.target.result);\r\n    setSongsArray(cloneArray);\r\n  }\r\n\r\n  const [event1, setEvent1] = useState(null);\r\n\r\n  const handleClickOpen = (e) => {\r\n    setOpen(true);\r\n    setIndex(\"200\");\r\n    setEvent1(e);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setIndex(\"-20000\");\r\n    setOpen(false);\r\n  };\r\n\r\n  function insertSelectedSongsAndInvestigration(status) {\r\n\r\n    handleToggle1();\r\n    var files1 = event1.target.files;\r\n    var listOfSongConcat = [];\r\n    const files = files1;\r\n    var numberOfFiles = files.length;\r\n    var p = 0;\r\n   this.setIsDisable(true);\r\n  //  useEffect(() => {  }, []);\r\n    Object.keys(files).forEach(i => {\r\n      const file = files[i];\r\n      const reader = new FileReader();\r\n      reader.onload = (event1) => {\r\n      \r\n      alert(isDisable);\r\n        updateSongArray(event1);\r\n        var obj = {};\r\n        obj[\"SongContect\"] = event1.target.result;\r\n        obj[\"UserId\"] = window.Store.getState().UserId;\r\n        obj[\"IsPermit\"] = status;\r\n       \r\n        listOfSongConcat.push(obj);\r\n        if (listOfSongConcat.length == numberOfFiles)//הכנסת השירים למסד הנתונים\r\n        {\r\n          var k = 0;\r\n\r\n          for (k = k; k < listOfSongConcat.length; k++) {\r\n            var json4 = JSON.stringify(listOfSongConcat[k]);\r\n\r\n\r\n            fetch(\"http://localhost:62135/api/values/addSong\", {\r\n              method: \"post\",\r\n              headers: { 'Content-Type': 'application/json' },\r\n              body: json4\r\n            })\r\n\r\n              .then(res => res.json())\r\n\r\n              .then((res) => {\r\n\r\n                debugger;\r\n                if (res.Status == true) {\r\n\r\n                  setSeverity(\"success\");\r\n                  setAlertContent(res.Message+\" השיר יהא זמין להורדה ולצפיה מהכניסה הבאה לאתר .  \");\r\n                  showError();\r\n                  p = p + 1;\r\n                  if (p == numberOfFiles) {\r\n                    handleClose1();\r\n                  }\r\n                  var thisSong = res.Data;\r\n\r\n                  var newSong = {\r\n                    songId: thisSong.songId,\r\n                    songName: thisSong.songName,\r\n                    neatTags: thisSong.neatTags,\r\n                    pointsTags: thisSong.pointsTags,\r\n                    isPermit:thisSong.isPermit,\r\n                    tag1: thisSong.tag1,\r\n                    tag2: thisSong.tag2,\r\n                    tag3: thisSong.tag3,\r\n                    userId: thisSong.userId,\r\n                    userName: thisSong.userName\r\n                    \r\n                    // עידכון השיר בטבלה מיד לאחר שמעלים אותו\r\n                    // מסובך מאד, כי הוספת השיר לא מביאה את השיר ואת תגיותיו והנקודות. בסי שארפ כדאי לשנות. ?\r\n\r\n                  }\r\ndebugger;\r\n                  var cloneSongList = songList;\r\n\r\n                  cloneSongList = cloneSongList.concat(newSong);\r\n                  dispatch({ type: 'SET_SONG_LIST', payload: cloneSongList });\r\n\r\n                }\r\n\r\n                else {\r\n                  setSeverity(\"error\");\r\n\r\n                  setAlertContent(res.Message);\r\n                  showError();\r\n                  // alert(\"failed\");\r\n                  p = p + 1;\r\n                  if (p == numberOfFiles) {\r\n                    handleClose1();\r\n                  }\r\n                }\r\n\r\n              },\r\n                (err) => {\r\n                  setSeverity(\"error\");\r\n                  showError(\" שגיאה כללית. נסה שנית \");\r\n                  handleClose1();\r\n\r\n                })\r\n          }\r\n        }\r\n      }\r\n      reader.readAsText(file);\r\n      \r\n    });\r\n\r\n    setIndex(\"-300\");\r\n    debugger;\r\n    //appHistory.go(0);//is is refresh this page?, maybe: 0\r\n    alert(isDisable);\r\n    this.setIsDisable(false);\r\n   // useEffect(() => {  }, [])\r\n\r\n    alert(isDisable);\r\n  }\r\n\r\n  function callSetIsDisable(){\r\n    setIsDisable(false);\r\n  }\r\n  const [index, setIndex] = useState(\"20\");\r\n\r\n  function showError() {\r\n\r\n    //למשך 10 שניות הצגת ההודעה\r\n    setTimeout(function () {\r\n      setErrorPlay(\"none\");\r\n\r\n    }.bind(this), 5000);\r\n\r\n    setErrorPlay(\"\");\r\n  }\r\n\r\n  return (\r\n    <div className=\"upload\">\r\n\r\n      <Backdrop className={classes.backdrop} open={open1} >\r\n        <CircularProgress color=\"inherit\" />\r\n      </Backdrop>\r\n\r\n\r\n      <Dialog\r\n        //style={{position:\"fixed\", zIndex: index }} \r\n        dir=\"rtl\"\r\n        open={open}\r\n        //TransitionComponent={Transition}\r\n        //keepMounted\r\n        onClose={handleClose}\r\n        aria-labelledby=\"alert-dialog-slide-title\"\r\n        aria-describedby=\"alert-dialog-slide-description\"\r\n      >\r\n        <DialogTitle id=\"alert-dialog-slide-title\">{\"בקשת הסכמת הלקוח לשתף את השיר במאגר\"}</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText id=\"alert-dialog-slide-description\" >\r\n            שלום. האם ברצונך לאשר את שיתוף השיר במאגר הגלובלי\r\n             ? אם הינך מאשר, אלגוריתם השיום יהיה מדויק, אמין ונכון יותר!\r\n          </DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => {\r\n\r\n            handleClose();\r\n            \r\n            insertSelectedSongsAndInvestigration(false);\r\n\r\n          }} color=\"primary\">\r\n            אני מוחה על כך\r\n          </Button>\r\n          <Button onClick={() => {\r\n            handleClose();\r\n            \r\n            insertSelectedSongsAndInvestigration(true);\r\n\r\n          }} color=\"primary\">\r\n            בהחלט!\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n\r\n      <input type=\"button\" style={{backgroundColor:\"white\"}} className=\"uploadButton\" width=\"20px \" value=\"\" />\r\n      <input onChange={(e) => {\r\n        handleClickOpen(e);\r\n\r\n\r\n      }} type=\"file\"  disabled={isDisable} multiple name=\"upload\" accept=\".txt\" id=\"fileUpload\" />\r\n\r\n    </div>\r\n\r\n  );\r\n}))"]},"metadata":{},"sourceType":"module"}